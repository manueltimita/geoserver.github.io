<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>OGC Filter Injection Vulnerability Statement</title>
    <meta name="viewport" content="width=device-width">
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,800" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="/css/bootstrap-3.0.3.min.css">
    <link rel="stylesheet" href="/css/ol.css"/>
    <link rel="stylesheet" href="/css/app.css">
    <link rel="alternate" type="application/atom+xml" title="Atom feed" href="https://geoserver.org/feed.xml">

    <link rel="shortcut icon" href="/favicon.ico">
  </head>

  <body >
      <nav class="navbar" role="navigation">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" 
              data-target="#gs-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">GeoServer</a>
    </div>

    <div class="collapse navbar-collapse" id="gs-navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="/about">About</a>
        </li>
        <li>
          <a href="/blog" target="_blank">Blog</a>
        </li>        
        <li>
          <a href="/download">Download</a>
        </li>
        <li>
          <a href="http://docs.geoserver.org">Documentation</a>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="/comm">Community Support</a></li>
            <li><a href="/support">Commercial Support</a></li>
            <li><a href="/issues">Issue Tracker</a></li>
            <li><a href="/devel">Community Development</a></li>
            <li><a href="/sponsor">Sponsorship</a></li>
            <li><a href="/roadmap">Roadmap</a></li>
            <li><a href="https://github.com/geoserver/geoserver/wiki/Home" target="_blank">Wiki</a></li>
            <li><a href="https://github.com/geoserver/geoserver/graphs/contributors">Contributors</a></li>
            <li><a href="https://github.com/geoserver/geoserver/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
            <li><a href="/license">License</a></li>
          </ul>
        </li>
      </ul>
    </div>
    <a href="https://github.com/geoserver/geoserver" target="_blank">
      <img style="position: absolute; top: 0; right: 0; border: 0;"
           decoding="async" loading="lazy" width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_green_007200.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1">
    </a>
  </nav>

      <div class="background">
        <div class="post-body">
          <div class="wrapper /vulnerability/2023/02/20/ogc-filter-injection">
            <div class="content">
              <div class="post">

                <header class="post-header">
                  <h1 class="post-title">OGC Filter Injection Vulnerability Statement</h1>
                  <p class="post-meta">Feb 20, 2023 • Jody Garnett</p>
                </header>

                <article class="post-content">
                  <p>A vulnerability has located in the GeoTools Library that allows SQL Injection using OGC Filter and Function expressions.</p>

<ul>
  <li><a href="https://github.com/geoserver/geoserver/security/advisories/GHSA-7g5f-wrx8-5ccf">CVE-2023-25157 OGC Filter SQL Injection Vulnerabilities</a> (GeoServer)</li>
  <li><a href="https://github.com/geotools/geotools/security/advisories/GHSA-99c3-qc2q-p94m">CVE-2023-25158 OGC Filter SQL Injection Vulnerabilities</a> (GeoTools)</li>
</ul>

<p>If you wish to report a security vulnerability, see instructions on <a href="http://geoserver.org/issues/">responsible reporting</a>.
We also welcome <a href="https://github.com/geoserver/geoserver/wiki/Sponsor">your direct financial support</a>.</p>

<h2 id="assessment">Assessment</h2>

<p>SQL Injection Vulnerabilities have been found with:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">PropertyIsLike</code> filter, when used with a String field and any relational database based Store, or with a PostGIS DataStore with encode functions enabled, or with any image mosaic with an index stored in a relational database.</li>
  <li><code class="language-plaintext highlighter-rouge">strEndsWith</code> function, when used with a PostGIS DataStore with encode functions enabled</li>
  <li><code class="language-plaintext highlighter-rouge">strStartsWith</code> function, when used with a PostGIS DataStore with encode functions enabled</li>
  <li><code class="language-plaintext highlighter-rouge">FeatureId</code> filter, when used with any database table having a String primary key column and when prepared statements are disabled</li>
  <li><code class="language-plaintext highlighter-rouge">jsonArrayContains</code> function, when used with a String or JSON field and with a PostGIS or Oracle DataStore (GeoServer 2.22.0+ only)</li>
  <li><code class="language-plaintext highlighter-rouge">DWithin</code> filter, when used with an Oracle DataStore</li>
</ul>

<h2 id="mitigation">Mitigation</h2>

<p>We recommend upgrading. The following list of mitigations is addressing some of the issues (e.g., the <code class="language-plaintext highlighter-rouge">PropertyIsLike</code> issue has no mitigation for tables with a string field):</p>

<ol>
  <li>Disabling the PostGIS Datastore <em>encode functions</em> setting to mitigate <code class="language-plaintext highlighter-rouge">strEndsWith</code>, <code class="language-plaintext highlighter-rouge">strStartsWith</code> (will cause severe slowdowns in parts of the WMTS multidimensional plugin functionality, if in use).</li>
  <li>Enabling the PostGIS DataStore <em>preparedStatements</em> setting to mitigate the <code class="language-plaintext highlighter-rouge">FeatureId</code> vulnerability.</li>
  <li>No mitigation is available for <code class="language-plaintext highlighter-rouge">PropertyIsLike</code> filter, you may choose to disable database DataStores until you are able to upgrade.</li>
  <li>No mitigation is available for <code class="language-plaintext highlighter-rouge">DWithin</code> with Oracle DataStore, you may choose to disable Oracle DataStores until you are able to upgrade.</li>
  <li>As a good practice to limit the attack surface, it’s important to give the database account used for connection pools the minimum required level of privileges (e.g., read-only unless WFS-T/importer/REST granule harvesting are used, access limited only to the schemas and tables needed for production usage)</li>
</ol>

<h2 id="resolution">Resolution</h2>

<p>Issues:</p>

<ul>
  <li><a href="https://osgeo-org.atlassian.net/browse/GEOT-7302">GEOT-7302 Escape user inputs in SQL queries</a></li>
  <li><a href="https://osgeo-org.atlassian.net/browse/GEOS-10842">GEOS-10842 Escape user inputs in SQL queries</a></li>
  <li>
    <p><a href="https://osgeo-org.atlassian.net/browse/GEOS-10839">GEOS-10839 Add JDBC Configuration parameter to disable SQL comments and pretty-printing</a></p>

    <p>A related issue with the community jdbc-config module.</p>
  </li>
</ul>

<p>Patched releases:</p>

<ul>
  <li><a href="/announcements/2023/04/05/geoserver-2-23-0-released.html">GeoServer 2.23.0</a> scheduled release</li>
  <li><a href="/announcements/2023/02/20/geoserver-2-22-2-released.html">GeoServer 2.22.2</a> stable release</li>
  <li><a href="/announcements/2023/02/20/geoserver-2-21-4-released.html">GeoServer 2.21.4</a> maintenance</li>
  <li><a href="/announcements/2023/02/20/geoserver-2-20-7-released.html">GeoServer 2.20.7</a></li>
  <li><a href="/announcements/2023/02/20/geoserver-2-19-7-released.html">GeoServer 2.19.7</a></li>
  <li><a href="/announcements/2023/02/20/geoserver-2-18-7-released.html">GeoServer 2.18.7</a></li>
</ul>

<p>If you wish to volunteer to backport these fixes to other GeoServer series and make a release co-ordinate on the <a href="https:/devel/">developers list</a>. If you are not in a position to collaborate reach out to a <a href="https:/support">commercial support provider</a> to act on your behalf.</p>

<p>Thanks to <a href="https://github.com/sikeoka">Steve Ikeoka</a> for responsibly reporting and fixing these issues. Thanks to Jody Garnett (GeoCat) for the stable and maintenance releases. Thanks to Andrea Aime (GeoSolutions) for back porting this fix to versions of GeoTools and GeoServer that are otherwise no longer receiving releases.</p>

                </article>

            </div>
          </div>
        </div>
        <div class="sidebar">
          <script>
            function toggleContents(target) {
              if (target.classList.contains('toggled')) {
                target.classList.remove('toggled')
              } else {
                target.classList.add('toggled')
              }
            }
          </script> 
          <div class="sidebar-category" onclick="toggleContents(this)" />
            <h4>&nbsp;Announcements</h4>
            <ul>
              
                <li><a href="/announcements/2023/12/18/geoserver-2-23-4-released.html">GeoServer 2.23.4 Release</a></li>
                
              
                <li><a href="/announcements/2023/11/27/geoserver-2-24-1-released.html">GeoServer 2.24.1 Release</a></li>
                
              
                <li><a href="/announcements/2023/10/30/geoserver-2-23-3-released.html">GeoServer 2.23.3 Release</a></li>
                
              
                <li><a href="/announcements/2023/10/15/geoserver-2-24-0-released.html">GeoServer 2.24.0 Release</a></li>
                
              
                <li><a href="/announcements/2023/09/25/geoserver-2-24-RC-released.html">GeoServer 2.24-RC Release</a></li>
                
              
                <li><a href="/announcements/2023/08/30/geoserver-2-22-5-released.html">GeoServer 2.22.5 Release</a></li>
                
              
                <li><a href="/announcements/2023/07/21/geoserver-2-23-2-released.html">GeoServer 2.23.2 Release</a></li>
                
              
                <li><a href="/announcements/2023/07/04/foss4g-2023.html">GeoServer at FOSS4G 2023</a></li>
                
              
                <li><a href="/announcements/2023/06/19/geoserver-2-22-4-released.html">GeoServer 2.22.4 Release</a></li>
                
              
                <li><a href="/announcements/2023/05/23/geoserver-2-23-1-released.html">GeoServer 2.23.1 Release</a></li>
                
                  
            </ul>
          </div>
          
          <!-- 2019 -->
          
            
            
            
              
            
            
            
            
            
            
          
            
            
            
            
            
              
            
            
            
            
            
            
          
            
            
            
            
            
              
            
            
            
            
            
              
            
            
            
            
            
              
            
            
            
            
            
            
          
            
            
            
            
            
              
            
            
            
            
            
            
          
          
          
          
            
            
            
            <div class="sidebar-category" onclick="toggleContents(this)" />
              <h4>&nbsp;Tutorials</h4>
              <ul>
                
                  
                  
                  
                  <li><a href="/tutorials/2024/01/17/geospatial-techno.html">GeoServer About & Status - A Practical Guide</a></li>
                  
                
                  
                  
                  
                  <li><a href="/tutorials/2023/11/30/geospatial-techno.html">GeoServer installation methods on Windows</a></li>
                  
                
                  
                  
                  
                  <li><a href="/tutorials/2023/10/20/geospatial-techno.html">Introducing GeoSpatial Techno with a Video Tutorial</a></li>
                  
                
                  
                  
                  
                  <li><a href="/tutorials/2019/09/03/geoserver-presentations-on-foss4g-2019.html">GeoServer Presentations on FOSS4G 2019</a></li>
                  
                
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
              </ul>
            </div>
          
            
            
            
            <div class="sidebar-category" onclick="toggleContents(this)" />
              <h4>&nbsp;Behind The Scenes</h4>
              <ul>
                
                  
                  
                  
                  <li><a href="/behind%20the%20scenes/2024/01/03/roadmap.html">GeoServer 2024 Roadmap Planning</a></li>
                  
                
                  
                  
                  
                  <li><a href="/behind%20the%20scenes/2022/01/20/log4j-upgrade.html">Log4j1 update or replace activity</a></li>
                  
                
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
              </ul>
            </div>
          
            
            
            
            <div class="sidebar-category" onclick="toggleContents(this)" />
              <h4>&nbsp;Vulnerability</h4>
              <ul>
                
                  
                  
                  
                  <li><a href="/vulnerability/2023/02/20/ogc-filter-injection.html">OGC Filter Injection Vulnerability Statement</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2022/11/18/geoserver-2-22-0-released.html">GeoServer 2.22.0 Release</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2022/10/24/geoserver-2-21-2-released.html">GeoServer 2.21.2 Release</a></li>
                  
                
                  
                  
                  
                  <li><a href="/vulnerability/2022/04/11/geoserver-2-jiffle-jndi-rce.html">Jiffle and GeoTools RCE vulnerabilities</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2022/04/11/geoserver-2-20-4-released.html">GeoServer 2.20.4 Released</a></li>
                  
                
                  
                  
                  
                  <li><a href="/vulnerability/2022/04/01/spring.html">Spring4Shell RCE vulnerability</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2022/03/08/geoserver-2-20-3-released.html">GeoServer 2.20.3 Released</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2022/03/08/geoserver-2-19-5-released.html">GeoServer 2.19.5 Released</a></li>
                  
                
                  
                  
                  
                  <li><a href="/announcements/vulnerability/2021/12/22/geoserver-2-19-4-released.html">GeoServer 2.19.4 Released</a></li>
                  
                
                  
                  
                  
                  <li><a href="/vulnerability/2021/12/13/logj4-rce-statement.html">Log4J2 zero day vulnerability assessment</a></li>
                  
                    
              </ul>
            </div>
          
            
            
            
            <div class="sidebar-category" onclick="toggleContents(this)" />
              <h4>&nbsp;Developer notes</h4>
              <ul>
                
                  
                  
                  
                  <li><a href="/developer%20notes/2021/03/04/main-branch.html">GeoServer repository transition to main branch</a></li>
                  
                
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
                  
                  
                    
              </ul>
            </div>
          
        </div>
      </div>
      <div id="footer">
    <span class="left"><a href="https://geoserver.org/feed.xml"><img alt="Atom feed" src="https://geoserver.org/img/rss-icon.png" height="16" width="16">Atom feed</a></span>
    <span class="right">
        &copy;2024 <a href="https://www.osgeo.org/">Open Source Geospatial Foundation</a>. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
    </span>
</div>

    </div>
        <script src="/js/jquery-1.11.1.min.js"></script>
    <script src="/js/bootstrap-3.0.3.min.js"></script>
    <script src="/js/ol.js"></script>
    <script src="/js/app.js"></script>
    <script>
    $(document).ready(function() {
        if (typeof window.init != "undefined") {
          init();
        }
    });
    </script>
    
  </body>
</html>
